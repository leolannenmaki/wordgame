var wordgame=function(i){var l=function(){function a(){this.wrapper=this.workingDir=this.id=this.fileName=this.exports=null}function f(d){return d.replace(/\/?[^\/]*$/,"")}function e(d){(d=d.match(/\/?([\w_-]+)\.js$/))&&(d=d[1]);return d}function b(d,j,k){!j&&(j=[]);return function(){var m=Array.prototype.slice.call(j,0);Array.prototype.push.apply(m,arguments);return d.apply(k,m)}}function g(d,j){if(d.substring(0,1)=="/"||/^\w+\:\/\//.test(d))return d;/\/$/.test(j)&&(j=j.substring(0,j.length-1));
/^\.\//.test(d)&&(d=d.substring(2,d.length));if(d.substring(0,3)=="../"){var k=d.match(/^(?:\.\.\/)+/)[0].match(/\//g).length;j=j.replace(RegExp("(\\/?\\w+){"+k+"}$"),"");d=d.replace(RegExp("(\\.\\.\\/){"+k+"}"),"")}return(j&&j+"/"||"")+d}function c(d,j){!/\.js(\?.*)?$/.test(j)&&(j+=".js");var k=g(j,d),m=h[k];if(!m)throw Error('Cannot find module "'+j+'". (Working Dir:'+d+", URI:"+k+" )");m.exports==null&&m.call();return m.exports}var h={};a.prototype.call=function(){this.exports={};return this.wrapper.call(null,
this.exports,this,b(c,[this.workingDir],null),i)};return{Module:a,cache:h,defineModule:function(d,j){var k=new a;k.wrapper=j;k.fileName=d;k.id=e(k.fileName);k.workingDir=f(k.fileName);return h[k.fileName]=k},getDir:f,getId:e,getModuleByFilename:function(d){return h[d]},partial:b,resolvePath:g,require:c}}();return{_jsbuild_:l,require:l.partial(l.require,[""])}}(this);
wordgame._jsbuild_.defineModule("common/board.js",function(i){function l(a,f){this.size=a;this.xy=[];this.yx=[];this.wordValidator=f||function(){return true};for(var e=0;e<a;e+=1){this.xy[e]=[];this.yx[e]=[];for(var b=0;b<a;b+=1)this.xy[e][b]=this.yx[e][b]=" "}}l.prototype={getSize:function(){return this.size},set:function(a,f,e){if(a<this.size&&f<this.size&&typeof e==="string"&&e.length==1){this.xy[f][a]=this.yx[a][f]=e;return this}throw Error("Out of bounds or invalid type");},isValid:function(){function a(e){return e.map(function(b){return b.join("").trim()}).filter(function(b){return b.length>
1}).every(function(b){return f.wordValidator(b)})}var f=this;return a(this.xy)&&a(this.yx)},toString:function(){for(var a=0,f="";a<this.size;a+=1)f+="["+this.xy[a].join("")+"]\n";return f},eachTile:function(a){for(var f=0,e=0;e<this.size;e+=1)for(f=0;f<this.size;f+=1)a(f,e,this.xy[e][f])}};i.Board=l});
wordgame._jsbuild_.defineModule("common/game.js",function(i,l,a){function f(b,g,c){this.size=b;this.board=new e(this.size,g);this.players=[];this.inTurn=0;this.turnBuffer=[];this.tileSet=c||null}var e=a("./board").Board;a("./tileset");f.prototype={addPlayer:function(b){this.players.push(b);return this},startGame:function(){if(this.players<2)throw Error("Not enough players");this.tileSet!==null&&this.tileSet.giveStartingTilesTo(this.players);return this},whosTurn:function(){return this.players[this.inTurn]},
setTile:function(b,g,c){console.log("Setting:",b,g,c);this.turnBuffer.push({x:b,y:g,c:(c||" ").toUpperCase()});return this},endTurn:function(){console.log("Ending "+this.whosTurn().getName());var b=this,g=this.turnBuffer.reduce(function(c,h){b.board.set(h.x,h.y,h.c);return c+Number(b.whosTurn().removeTile(h.c).getValue())},0);this.whosTurn().addPoints(g);if(this.inTurn+1===this.players.length)this.inTurn=0;else this.inTurn++;g=this.turnBuffer;this.turnBuffer=[];return g},getBoard:function(){return this.board}};
i.Game=f});
wordgame._jsbuild_.defineModule("common/player.js",function(i,l,a,f,e){function b(c,h,d){this.name=c;this.tiles=h||[];this.points=d||0}var g=a("./tile").Tile;b.fromJson=function(c){var h=null;h=typeof c==="string"?JSON.parse(c):c;if(h.name!==e&&h.points!==e){var d=new b(String(h.name),Number(h.points));h.tiles&&h.tiles.length&&h.tiles.map(function(j){d.addTile(g.fromJson(j))});return d}throw Error("Data did not contain name and points");};b.prototype={getName:function(){return this.name},addTile:function(c){console.log(this.name+
" got Tile: "+c.getLetter());this.tiles.push(c);return this},getTiles:function(){return this.tiles},removeTile:function(c){console.log("From: "+this.name+" removing "+c);for(var h=0;h<this.tiles.length;h++)if(this.tiles[h].getLetter()===String(c))return this.tiles.splice(h,1)[0];throw Error("Player doesn't have that tile anymore");},getPoints:function(){return this.points},addPoints:function(c){return this.points+=c},toJson:function(){return{name:this.name,tiles:this.tiles.map(function(c){return c.toJson()}),
points:this.points}}};i.Player=b});
wordgame._jsbuild_.defineModule("common/tile.js",function(i,l,a,f,e){function b(g,c){this.letter=(g||" ").toUpperCase();this.value=c||0}b.fromJson=function(g){var c=null;c=typeof g==="string"?JSON.parse(g):g;if(c.letter!==e&&c.value!==e)return new b(String(c.letter),Number(c.value));throw Error("Data did not contain letter and value");};b.prototype={getValue:function(){return this.value},getLetter:function(){return this.letter},toJson:function(){return{letter:this.getLetter(),value:this.getValue()}}};
i.Tile=b});
wordgame._jsbuild_.defineModule("common/tileset.js",function(i,l,a){function f(b){this.language=b||"en";this.tiles=this.createSet()}var e=a("./tile").Tile;f.prototype={tiles:{en:{"0":{" ":2},"1":{E:12,A:9,I:9,O:8,N:6,R:6,T:6,L:4,S:4,U:4},"2":{D:4,G:3},"3":{B:2,C:2,M:2,P:2},"4":{F:2,H:2,V:2,W:2,Y:2},"5":{K:1},"8":{J:1,X:1},"10":{Q:1,Z:1}}},createSet:function(){var b=[],g;for(g in this.tiles[this.language])for(var c in this.tiles[this.language][g])for(var h=0;h<this.tiles[this.language][g][c];h++)b.push(new e(c,g));
return b},getTiles:function(){return this.tiles},tilesLeft:function(){return this.tiles.length},getRandomTile:function(){if(this.tilesLeft()===0)throw Error("No tiles left");return this.tiles.splice(Math.round(Math.random()*(this.tilesLeft()-1)),1)[0]},giveStartingTilesTo:function(b){for(var g=0;g<b.length*7;g++)b[g%b.length].addTile(this.getRandomTile())}};i.TileSet=f});
wordgame._jsbuild_.defineModule("common.js",function(i,l,a){i.Board=a("./common/board").Board;i.Game=a("./common/game").Game;i.Player=a("./common/player").Player;i.Tile=a("./common/tile").Tile;i.TileSet=a("./common/tileset").TileSet});
wordgame._jsbuild_.defineModule("client/domboard.js",function(i){function l(a,f){this.active=false;var e=$('<div id="wordgame-board"></div>').appendTo(a),b=this,g=[];this.tiles=g;f.eachTile(function(c,h,d){d=$("<div>"+d+"</div>").css({top:100+h*30+"px",left:c*30+"px"}).droppable({drop:function(j,k){if(b.active){var m=k.draggable.find("span:first").text();console.log("dropped "+m);k.draggable.remove();$("#wordgame").trigger("wordgame.setTile",[c,h,m])}},activate:function(){$(this).css("border-color",
"green")},deactivate:function(){$(this).css("border-color","black")}}).appendTo(e);g.length===c&&g.push([]);g[c].push(d)})}l.prototype.setTile=function(a,f,e){a=this.tiles[a][f];if(a.text().trim().length===0)a.text(e.trim().length>0?e:"?")};l.prototype.deactivate=function(){this.active=false};l.prototype.activate=function(){this.active=true};i.DomBoard=l});
wordgame._jsbuild_.defineModule("client/domtileset.js",function(i){i.DomTileSet=function(l,a){var f=$('<div id="wordgame-tileset"></div>').appendTo(l);a.forEach(function(e){$(f).append($('<div><span class="letter">'+e.getLetter()+'</span><span class="value">'+e.getValue()+"</span></div>").click(function(){}).draggable({revert:true}))})}});wordgame._jsbuild_.defineModule("client.js",function(i,l,a){i.DomTileSet=a("./client/domtileset").DomTileSet;i.DomBoard=a("./client/domboard").DomBoard});
